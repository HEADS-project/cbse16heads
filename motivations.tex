\section{Motivations}
\subsection{Challenges engineering a modern eHealth service}

eHealth is a growing market in Europe and world-wide, in particular due to the ageing of our societies. 15 millions elderly in Europe are already equipped with a tele-care alarm, typically in the form of a simple necklace button that the elderly can press in case she needs help. This will in turn put the elderly in contact with medical services. While tele-care alarm services are of course very useful services, more and more promoted by public authorities, operating those services is however not an easy task due to the numerous false positive (elderly pushing the button while everything is fine) and false negative alarms (elderly not able to push the button e.g. after a fall). This drastically hinders the safety and cost-efficiency of tele-care services. 
To improve tele-care services and help elderly to stay home as long as possible, TellU is currently developing a smart-home system to control equipment that are normally present in smart homes to make life more comfortable (automatic light control, door locks, and heater control, etc.) and safer for elderly people. One of the main fears for elderly people is the fear for falling and not being helped. This fear causes elderly to isolate and become less active, which in turn make them more exposed to illness. In addition to integrating home-automation equipment, TellU is developing a fall detection system (patent pending) based on a distributed sensor network for measurements of air pressure from both stationary and wearable sensors. This distributed sensor network in addition provides a way locate elderly within their homes. Physicians, care-givers, family etc. can use this information to monitor if the elderly residents have an adequate activity level during the day. Furthermore, several services can be automated based on measured indoor locations and controllable equipment, e.g. light control, turn of stove when leaving house, etc. TellU also plan to include sensors for measuring physiological parameters like heart-rate and skin temperature. In this way care-givers can monitor if the elderly resident is not feeling well. Fall detection and heart-rate monitoring should also be applicable outdoors to give the elderly the needed confidence that they will get assistance if they need help outside of the home. 

eHealth and many other types are services are no longer one-device services but need to leverage a large number of heterogeneous software and hardware platforms to fully complete their goals. Developers are thus facing new Software Engineering challenges as detailed in the next sub-section. 

\subsection{Software Engineering Challenges}

The infrastructure supporting Heterogeneous and Distributed services (HD services) typically spans across a continuum of devices and platforms ranging from microcontroller-based devices up to Clouds. Software for the different classes of devices are typically built using different approaches and languages. In order to understand the skills and capabilities required to develop services on top of such an infrastructure, we queried a popular open-source repository (GitHub) to evaluate the heterogeneity of programming languages across the continuum~\cite{DBLP:conf/icse/MorinFB15}. The following sets of keywords were used: 1) Cloud: server with virtually unlimited resources, 2) Microcontroller: resource constrained node (few KB RAM, few MHz), 3) Mobile: an intermediate node, typically a smartphone, 4) Internet of Things: Internet-enabled devices, 5) Distributed systems, as services exploiting Cyber Physical Systems (CPS) have to be distributed across the continuum, and 6) Embedded systems, as a large and important part of the service implementations will run as close as possible to physical world, embedded into sensors, devices and gateways. 

This study indicates that no programming language is popular across the whole continuum: Java and JavaScript (and to some extent, Python and Ruby) are popular in the higher-end of the continuum (cloud and mobile) but not popular for the lower end, whereas C (and to some extent, C++) is a clear choice for developers targeting embedded and microcontroller-based systems.% Other languages do not score more 10\% for any of the keywords. For all keywords except Cloud, the combined popularity of Java, JavaScript and C/C++ (i.e, the sum of the percentages) is above 70\%. For Cloud we observe a certain homogeneity with Python, Ruby also being very popular, so the combined popularity of Java, JS and C/C++ is only 50\%. It is also worth noticing that the most popular language for a given keyword scores very poorly (less than 5\%) for at least another keyword. 

While it might appear that a combination of C/C++, JavaScript and Java should be able to cover the whole continuum of CPS, in practice it does not exclude the need for other programming languages. For example, the Fibaro Home Center 2 (a gateway for home automation based on the Z-Wave protocol) uses Lua as scripting language to define automation rules. Another example is the BlueGiga BlueTooth Smart Module, which can be scripted using BGScript, a proprietary scripting language. This shows that each part of an infrastructure might require the use of a niche language, middleware or library to be exploited to its full potential. 

To tackle this heterogeneity, developers typically need to determine a trade-off between alternative solutions (described in details in \cite{DBLP:conf/icse/MorinFB15}). A typical solution consists in using Internet-connected devices that simply push all the data to bigger nodes (e.g. in the Cloud). This way, the service can be implemented homogeneously in a high-level language like Java on the larger nodes. However, this requires the devices to have a permanent Internet connection, which rapidly drains the batteries of mobile and wearable devices. Also, the whole service is likely to fail if the Internet connection is lost as the devices do not run any logic, which is not acceptable for a large set of safety-critical services. For this type of services, it is important that the logic can still run even after the failure of multiple nodes or communication channels. Some logic has to be implemented directly in micro-controllers, some logic in intermediate gateways and some logic can possibly be implemented in some backend or cloud servers. This requires a large team of developers with different skills (from a C/assembly coder optimizing bits and bytes to a Java developers implementing large-scale consensus algorithms to extract a coherent overview of the system). This implies high development and integration costs, which is acceptable compared to the price and safety requirements of a plane or a car, but which can significantly hinder the large adoption of e.g. eHealth services. 